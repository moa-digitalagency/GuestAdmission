{% extends "base_dashboard.html" %}

{% block title %}Platform Admin{% endblock %}
{% block page_title %}Platform Admin Dashboard{% endblock %}

{% block content %}
<!-- Navigation tabs -->
<div class="dotted-section section-blue" style="margin-bottom: 1.5rem; padding: 1rem;">
    <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
        <button class="btn btn-primary platform-tab active" data-section="dashboard" onclick="showSection('dashboard')">
            üìä Tableau de bord
        </button>
        <button class="btn btn-secondary platform-tab" data-section="tenants" onclick="showSection('tenants')">
            üë• Comptes clients
        </button>
        <button class="btn btn-secondary platform-tab" data-section="etablissements" onclick="showSection('etablissements')">
            üè¢ √âtablissements
        </button>
        <button class="btn btn-secondary platform-tab" data-section="users" onclick="showSection('users')">
            üë§ Utilisateurs
        </button>
        <button class="btn btn-secondary platform-tab" data-section="settings" onclick="showSection('settings')">
            ‚öôÔ∏è Param√®tres
        </button>
    </div>
</div>

<!-- Dashboard Section -->
<div id="dashboardSection" class="content-section">
    <h2 style="margin-bottom: 1.5rem;">Statistiques globales</h2>
    <div class="stats-grid">
        <div class="stat-card blue">
            <div class="stat-label">Comptes Tenants</div>
            <div class="stat-value" id="statTenantsActifs">0</div>
            <small style="color: #6b7280;">actifs</small>
        </div>
        <div class="stat-card green">
            <div class="stat-label">√âtablissements</div>
            <div class="stat-value" id="statEtablissementsActifs">0</div>
            <small style="color: #6b7280;">actifs</small>
        </div>
        <div class="stat-card purple">
            <div class="stat-label">Admins</div>
            <div class="stat-value" id="statTotalAdmins">0</div>
        </div>
        <div class="stat-card orange">
            <div class="stat-label">R√©servations</div>
            <div class="stat-value" id="statTotalReservations">0</div>
        </div>
    </div>
</div>

<!-- Tenants Section -->
<div id="tenantsSection" class="content-section" style="display: none;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
        <h2 style="margin: 0;">Comptes clients (Tenants)</h2>
        <button class="btn btn-success" onclick="openCreateTenantModal()">
            ‚ûï Cr√©er un compte client
        </button>
    </div>
    <div id="tenantsList" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 1.5rem;"></div>
</div>

<!-- Etablissements Section -->
<div id="etablissementsSection" class="content-section" style="display: none;">
    <h2 style="margin-bottom: 1.5rem;">Tous les √©tablissements</h2>
    <div id="etablissementsList" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1.5rem;"></div>
</div>

<!-- Users Section -->
<div id="usersSection" class="content-section" style="display: none;">
    <h2 style="margin-bottom: 1.5rem;">Tous les utilisateurs</h2>
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>Nom</th>
                    <th>Pr√©nom</th>
                    <th>Email</th>
                    <th>Username</th>
                    <th>√âtablissements</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="usersList"></tbody>
        </table>
    </div>
</div>

<!-- Settings Section -->
<div id="settingsSection" class="content-section" style="display: none;">
    <h2 style="margin-bottom: 1.5rem;">Param√®tres de la plateforme</h2>
    <div class="dotted-section section-purple">
        <h3 style="margin-bottom: 1rem;">Configuration g√©n√©rale</h3>
        <p style="color: #6b7280;">Les param√®tres de la plateforme seront disponibles ici prochainement.</p>
    </div>
</div>

<!-- Create Tenant Modal -->
<div class="modal" id="createTenantModal">
    <div class="modal-content" style="max-width: 800px;">
        <div class="modal-header">
            <h3 style="margin: 0;">Cr√©er un nouveau compte client</h3>
            <button class="modal-close" onclick="closeCreateTenantModal()">‚úï</button>
        </div>
        <form id="createTenantForm">
            <h4 style="margin-bottom: 1rem;">Informations du compte</h4>
            <div class="form-grid">
                <div class="form-group">
                    <label>Nom du compte *</label>
                    <input type="text" name="nom_compte" required>
                </div>
                <div class="form-group" style="grid-column: 1 / -1;">
                    <label>Notes</label>
                    <textarea name="notes" rows="2"></textarea>
                </div>
            </div>

            <hr style="margin: 1.5rem 0; border: none; border-top: 2px dotted #d1d5db;">
            <h4 style="margin-bottom: 1rem;">Premier √©tablissement</h4>
            <div class="form-grid">
                <div class="form-group">
                    <label>Nom de l'√©tablissement *</label>
                    <input type="text" name="nom_etablissement" required>
                </div>
                <div class="form-group">
                    <label>Ville</label>
                    <input type="text" name="ville">
                </div>
                <div class="form-group">
                    <label>Pays</label>
                    <input type="text" name="pays">
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" name="email">
                </div>
            </div>

            <hr style="margin: 1.5rem 0; border: none; border-top: 2px dotted #d1d5db;">
            <h4 style="margin-bottom: 1rem;">Admin principal du compte</h4>
            <div class="form-grid">
                <div class="form-group">
                    <label>Nom d'utilisateur *</label>
                    <input type="text" name="admin_username" required>
                </div>
                <div class="form-group">
                    <label>Mot de passe *</label>
                    <input type="password" name="admin_password" required>
                </div>
                <div class="form-group">
                    <label>Nom</label>
                    <input type="text" name="admin_nom">
                </div>
                <div class="form-group">
                    <label>Pr√©nom</label>
                    <input type="text" name="admin_prenom">
                </div>
                <div class="form-group" style="grid-column: 1 / -1;">
                    <label>Email de l'admin</label>
                    <input type="email" name="admin_email">
                </div>
            </div>

            <div class="button-group" style="justify-content: flex-end;">
                <button type="button" class="btn btn-secondary" onclick="closeCreateTenantModal()">Annuler</button>
                <button type="button" class="btn btn-primary" onclick="createTenant()">Cr√©er</button>
            </div>
        </form>
    </div>
</div>

{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/platform_admin.js') }}"></script>
{% endblock %}
